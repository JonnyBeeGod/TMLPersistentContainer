<!DOCTYPE html>
<html lang="en">
  <head>
    <title>PersistentContainer Class Reference</title>
    <link rel="stylesheet" type="text/css" href="../css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="../css/highlight.css" />
    <meta charset="utf-8">
    <script src="../js/jquery.min.js" defer></script>
    <script src="../js/jazzy.js" defer></script>
    
    <script src="../js/lunr.min.js" defer></script>
    <script src="../js/typeahead.jquery.js" defer></script>
    <script src="../js/jazzy.search.js" defer></script>
  </head>
  <body>

    <a name="//apple_ref/swift/Class/PersistentContainer" class="dashAnchor"></a>

    <a title="PersistentContainer Class Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="../index.html">
          TMLPersistentContainer Docs
        </a>
         (100% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="../search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/johnfairh/TMLPersistentContainer">
            <img class="header-icon" src="../img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="../index.html">TMLPersistentContainer Reference</a>
      <img class="carat" src="../img/carat.png" />
      PersistentContainer Class Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../background.html">Background</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../usage.html">Usage</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Main APIs.html">Main APIs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Classes/PersistentContainer.html">PersistentContainer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/ModelVersionOrder.html">ModelVersionOrder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/MigrationError.html">MigrationError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Protocols/MigrationDelegate.html">MigrationDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="../Logging APIs.html">Logging APIs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Structs/LogMessage.html">LogMessage</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="../Enums/LogLevel.html">LogLevel</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            <h1>PersistentContainer</h1>
              <div class="declaration">
                <div class="language">
                  <pre class="highlight swift"><code><span class="kd">@available(OSX 10.12, iOS 10.0, tvOS 10.0, watchOS 3.0, *)</span>
<span class="kd">open</span> <span class="kd">class</span> <span class="kt">PersistentContainer</span> <span class="p">:</span> <span class="kt">NSPersistentContainer</span><span class="p">,</span> <span class="kt">LogMessageEmitter</span></code></pre>

                </div>
              </div>
            <p>A container for a Core Data stack that provides automatic multi-step shortest-path
persistent store migration.</p>

<p>This is a drop-in replacement for <code>NSPersistentContainer</code> that automatically detects
and performs multi-step store migration as part of the <code>loadPersistentStores</code> method.</p>

<p>The container searches for models and mapping models, then constructs the
best sequence in which to migrate stores. It prefers to use explicit mapping models
over inferred mapping models when there is a choice. Progress and status can be
reported back to the client code.</p>

<p>See <a href="https://johnfairh.github.io/TMLPersistentContainer/usage.html">the user guide</a> for more details.</p>

          </div>
        </section>

        <section class="section">
          <div class="section-content">
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:22TMLPersistentContainer010PersistentB0C17migrationDelegateAA09MigrationE0_pSgXwvp"></a>
                    <a name="//apple_ref/swift/Property/migrationDelegate" class="dashAnchor"></a>
                    <a class="token" href="#/s:22TMLPersistentContainer010PersistentB0C17migrationDelegateAA09MigrationE0_pSgXwvp">migrationDelegate</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Optional delegate to receive migration progress notifications.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">migrationDelegate</span><span class="p">:</span> <span class="kt"><a href="../Protocols/MigrationDelegate.html">MigrationDelegate</a></span><span class="p">?</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L40">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:22TMLPersistentContainer010PersistentB0CACSS4name_SaySo6BundleCG7bundlesAA17ModelVersionOrderO05modelhI0yAA10LogMessageVcSg03logL7Handlertcfc"></a>
                    <a name="//apple_ref/swift/Method/init(name:bundles:modelVersionOrder:logMessageHandler:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:22TMLPersistentContainer010PersistentB0CACSS4name_SaySo6BundleCG7bundlesAA17ModelVersionOrderO05modelhI0yAA10LogMessageVcSg03logL7Handlertcfc">init(name:bundles:modelVersionOrder:logMessageHandler:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Initializes a persistent container from a named model.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="n">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
                        <span class="nv">bundles</span><span class="p">:</span> <span class="p">[</span><span class="kt">Bundle</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="p">],</span>
                        <span class="nv">modelVersionOrder</span><span class="p">:</span> <span class="kt"><a href="../Enums/ModelVersionOrder.html">ModelVersionOrder</a></span> <span class="o">=</span> <span class="o">.</span><span class="n">compare</span><span class="p">,</span>
                        <span class="nv">logMessageHandler</span><span class="p">:</span> <span class="kt"><a href="../Structs/LogMessage.html">LogMessage</a></span><span class="o">.</span><span class="kt">Handler</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>name</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The name of the managed object model to use with the container.
  This name is used as the default name for the first persistent store.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>bundles</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>An array of bundles to search for the container&rsquo;s model. By default
     only the app&rsquo;s main bundle. If the model exists in multiple bundles then
     the first one in the array is used. If the model exists more than once
     in the same bundle then it is undefined which is used. These bundles are
     also used to search for data and mapping models during automatic multi-step
     store migration.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>modelVersionOrder</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The ordering algorithm of model versions used to guide automatic
               multi-step store migration. The default is a numeric string
               comparison, meaning that <code>MyModel1</code> precedes <code>MyModel2</code> precedes
               <code>MyModel10</code>.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>logMessageHandler</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>A callback to receive log messages from the library suitable for
               helping debug applications. Calls can occur on any queue.
               The default performs no logging.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L66-L99">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:22TMLPersistentContainer010PersistentB0CACSS4name_So20NSManagedObjectModelC07managedfG0SaySo6BundleCG7bundlesAA0G12VersionOrderO05modelkL0yAA10LogMessageVcSg03logO7Handlertcfc"></a>
                    <a name="//apple_ref/swift/Method/init(name:managedObjectModel:bundles:modelVersionOrder:logMessageHandler:)" class="dashAnchor"></a>
                    <a class="token" href="#/s:22TMLPersistentContainer010PersistentB0CACSS4name_So20NSManagedObjectModelC07managedfG0SaySo6BundleCG7bundlesAA0G12VersionOrderO05modelkL0yAA10LogMessageVcSg03logO7Handlertcfc">init(name:managedObjectModel:bundles:modelVersionOrder:logMessageHandler:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Initializes a persistent container using a managed object model.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="nf">init</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
            <span class="n">managedObjectModel</span> <span class="nv">model</span><span class="p">:</span> <span class="kt">NSManagedObjectModel</span><span class="p">,</span>
            <span class="nv">bundles</span><span class="p">:</span> <span class="p">[</span><span class="kt">Bundle</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="p">],</span>
            <span class="nv">modelVersionOrder</span><span class="p">:</span> <span class="kt"><a href="../Enums/ModelVersionOrder.html">ModelVersionOrder</a></span> <span class="o">=</span> <span class="o">.</span><span class="n">compare</span><span class="p">,</span>
            <span class="nv">logMessageHandler</span><span class="p">:</span> <span class="kt"><a href="../Structs/LogMessage.html">LogMessage</a></span><span class="o">.</span><span class="kt">Handler</span><span class="p">?)</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>name</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The defaut name for the first persistent store.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>model</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The managed object model to be used by the persistent container.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>bundles</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>An array of bundles used to search for data models and mapping models
     during automatic multi-step store migration.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>modelVersionOrder</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>The ordering algorithm of model versions used to guide automatic
               multi-step store migration. The default is a numeric string
               comparison, meaning that <code>MyModel1</code> precedes <code>MyModel2</code> precedes
               <code>MyModel10</code>.</p>
                                </div>
                              </td>
                            </tr>
                            <tr>
                              <td>
                                <code>
                                <em>logMessageHandler</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>A callback to receive log messages from the library suitable for
               helping debug applications. Calls can occur on any queue.
               The default performs no logging.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L119-L128">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:22TMLPersistentContainer010PersistentB0C13destroyStoresyyKF"></a>
                    <a name="//apple_ref/swift/Method/destroyStores()" class="dashAnchor"></a>
                    <a class="token" href="#/s:22TMLPersistentContainer010PersistentB0C13destroyStoresyyKF">destroyStores()</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Cleanly empty all the persistent stores described by <code>persistentStoreDescriptions</code>.
Typically useful to reset the app to a fresh state before loading the stores.</p>
<div class="aside aside-attention">
    <p class="aside-title">Attention</p>
    <p>May not remove files from disk. In the case of SQLite3 stores, database files
         making up an empty store are left.</p>

</div>
<div class="aside aside-attention">
    <p class="aside-title">Attention</p>
    <p>Goodness knows what this will do with custom stores. There does not appear to be
         an API into the <code>NSPersistentStore</code> tree to implement this operation.</p>

</div>
<div class="aside aside-attention">
    <p class="aside-title">Attention</p>
    <p>Not atomic with respect to multiple stores. The routine attempts to destroy
         each store one by one; the first destroy operation to fail causes the entire
         routine to fail.</p>

</div>
<div class="aside aside-throws">
    <p class="aside-title">Throws</p>
    <p>Errors thrown by <code>NSPersistentStoreCoordinator.destroyPersistentStore(at:ofType:options:)</code> which
      is undocumented: assumed to be filesystem access errors that the app should probably consider as
      fatal. Does <em>not</em> throw an error if a persistent store does not currently exist.</p>

</div>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">open</span> <span class="kd">func</span> <span class="nf">destroyStores</span><span class="p">()</span> <span class="k">throws</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L147-L152">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/c:@M@TMLPersistentContainer@objc(cs)PersistentContainer(im)loadPersistentStoresWithCompletionHandler:"></a>
                    <a name="//apple_ref/swift/Method/loadPersistentStores(completionHandler:)" class="dashAnchor"></a>
                    <a class="token" href="#/c:@M@TMLPersistentContainer@objc(cs)PersistentContainer(im)loadPersistentStoresWithCompletionHandler:">loadPersistentStores(completionHandler:)</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Begin loading and migrating the persistent stores mentioned in <code>persistentStoreDescriptions</code> that have
not already been loaded. The completion handler is called once for each such store on the main queue
indicating whether the store has been loaded successfully.</p>

<p>If the store description has <code>shouldMigrateStoreAutomatically</code> set then the container automatically
attempts multi-step migration.  If the store description also has <code>shouldInferMappingModelAutomatically</code>
set then the multi-step migration can include the use of inferred mapping models and light-weight
migration.  Once any multi-step migration is complete, Core Data is invoked to load the store and set
up the stack for use.</p>

<p>These flags are both on by default.</p>

<p>If <em>any</em> of the store descriptions have <code>shouldAddStoreAsynchronously</code> set then this routine returns
immediately and <em>all</em> migrations occur on a background queue.  This flag is off by default.</p>

<p>If the container has multiple stores then the container tries very hard to ensure either all stores
are migrated successfully or none are.</p>

                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">open</span> <span class="k">override</span> <span class="kd">func</span> <span class="nf">loadPersistentStores</span><span class="p">(</span><span class="n">completionHandler</span> <span class="nv">block</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">(</span><span class="kt">NSPersistentStoreDescription</span><span class="p">,</span> <span class="kt">Error</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="p">())</span></code></pre>

                        </div>
                      </div>
                      <div>
                        <h4>Parameters</h4>
                        <table class="graybox">
                          <tbody>
                            <tr>
                              <td>
                                <code>
                                <em>block</em>
                                </code>
                              </td>
                              <td>
                                <div>
                                  <p>Callback made on the main queue for each store when it has either been loaded successfully
               or failed to load.  The <code>Error</code> here can be anything provided by
               <code>NSPersistentContainer.loadPersistentStores</code> as well as anything from <code><a href="../Enums/MigrationError.html">MigrationError</a></code>
               in this package.</p>
                                </div>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L177-L256">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

      </article>
    </div>
    <section class="footer">
      <p>Distributed under the ISC license.  Maintained by John Fairhurst.</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.3</a>-<a class="link" href="https://github.com/johnfairh/jazzy" target="_blank" rel="external">bebop</a>, originally a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
